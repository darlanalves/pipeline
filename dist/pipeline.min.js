!function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),n=(function(){function e(){t(this,e),this.$$pipe=[]}return r(e,[{key:"push",value:function(e){return this.$$pipe.push(e),this}},{key:"run",value:function(e){var t=n.create(this.$$pipe);return t.value=e,t.next(),t.promise}}]),e}(),function(){function e(r){t(this,e);var n=this;this.setupSteps(r),this.promise=new Promise(function(e,t){n.__resolve=e,n.__reject=t}),this.index=-1,this.settled=!1}return r(e,[{key:"setupSteps",value:function(e){var t={request:[],response:[],requestError:[],responseError:[]};e.forEach(function(e){e.request?t.request.push({method:e.request,context:e}):t.request.push(null),e.requestError?t.requestError.push({method:e.requestError,context:e}):t.requestError.push(null),e.response?t.response.push({method:e.response,context:e}):t.response.push(null),e.responseError?t.responseError.push({method:e.responseError,context:e}):t.responseError.push(null)});var r=t.request.some(function(e){return null!==e});if(!r)throw new Error("This pipeline cannot handle requests");this.max=t.request.length,this.steps=t}},{key:"resolve",value:function(e){this.value=e,this.end()}},{key:"reject",value:function(e){this.error=e,this.end()}},{key:"dispatchResult",value:function(){var e=this.steps.response,t=Promise.resolve(this.value);if(e.length)for(var r=this.index+1,n=function(){var n=e[r];return n?void(t=t.then(function(e){return n.method.call(n.context,e)})):"continue"};r--;){n()}this.__resolve(t)}},{key:"dispatchError",value:function(){this.__reject(this.error)}},{key:"next",value:function(){this.settled||(this.index++,this.step(),this.index!==this.max||this.settled||this.reject(new Error("The input is not processable")))}},{key:"step",value:function(){if(!this.settled){var e=this.steps.request[this.index];e&&e.method.call(e.context,this)}}},{key:"end",value:function(){this.settled=!0,this.error?this.dispatchError():this.dispatchResult()}}],[{key:"create",value:function(t){return new e(t)}}]),e}());"function"==typeof define&&define.amd?define(function(){return MyLibrary}):"undefined"!=typeof module&&module.exports?module.exports=MyLibrary:e.MyLibrary=MyLibrary}(this);